## Руководство: добавление собственного языка в сборку

Ниже описан минимальный и безопасный путь добавить новый язык,
Основано на внедрённой системе языков из PR «Переработка кастомизации и рассовых фишек…» ([ссылка](https://github.com/Lua-Frontier/sector-frontier-14/pull/169)).

### 1) Создайте прототип языка (YAML)

Разместите файл в `Resources/Prototypes/_Backmen/Language/Species/<ваш_язык>.yml` (или подкаталог по вашему выбору в `_Backmen/Language/`).

```yml
---
- type: language
  id: MySpecies
  name: language-MySpecies-name
  obfuscation:
    !type:ReplacementObfuscation
      replacement: ["зик", "зар", "тук", "шак", "мир", "кек"]
  speech:
    color: "#FFFFFF"
    radioColor: "#FFFFFF"   # опционально; если не указать- возьмётся color
    allowRadio: true         # обязательно для работы языка по рации
  emote: MySpecies           # опционально, строковый идентификатор эмота
```

Важно:
- `replacement`- именно список строк. Одна строка вызовет ошибку разбора.
- `allowRadio: true`- включает обфускацию и по рации.
- Цвета- шестнадцатеричные в кавычках.

### 2) Локализация названия и описания

Добавьте записи в FTL для нужных локалей. Для `ru-RU` используйте (создайте при отсутствии) файл `Resources/Locale/ru-RU/_backmen/language/languages.ftl`:

```ftl
language-MySpecies-name = Мой язык
language-MySpecies-description = Краткое описание языка.
```

Эти ключи используются в меню выбора языка (кнопка «Выбрать» и блок описания подтягиваются автоматически).

### 3) Назначьте язык расе/сущности

Чтобы вид по умолчанию говорил на своём языке и «Межгалактическом», добавьте компонент `LanguageKnowledge` в базовый прототип вида (или в конкретную сущность):

```yml
- type: LanguageKnowledge
  speaks:
  - Intergalactic
  - MySpecies
  understands:
  - Intergalactic
  - MySpecies
```

Рекомендуем добавлять на `BaseMob<Вид>` в `Resources/Prototypes/Entities/Mobs/Species/...yml`, чтобы все производные сущности его наследовали.

### 4) Проверка в меню языков

После запуска сервера откройте меню языков (кнопка/бинд). Новый язык должен появиться с локализованным названием, описанием и кнопкой «Выбрать».

### 5) Радио: как это работает

При `allowRadio: true` язык обфусцируется при радиопередаче так же, как и в локальном чате (пер-слово), см. интеграцию на стороне радио. Ничего дополнительно делать не нужно.

### 6) Тестирование

1. Соберите проект.
2. Зайдите за вид со своим языком.
3. В локальном чате: фразы должны превращаться в набор слов из `replacement`, знаки препинания и пробелы сохраняются.
4. В рации: поведение то же самое.
5. Попробуйте разные слова/пунктуацию, чтобы убедиться, что всё стабильно.

### 7) Опционально: предметы-переводчики и учебники

— Учебник языка (даёт знание языка после использования):

```yml
- type: entity
  parent: BaseItem
  id: ManualMySpecies
  name: учебник языка «Мой язык»
  components:
  - type: LanguageLearn
    deleteAfterUse: true
    languages:
      - MySpecies
```

— Ручной переводчик (даёт возможность говорить/понимать язык при активном устройстве):

```yml
- type: entity
  id: MySpeciesTranslator
  parent: TranslatorPoweredBase
  suffix: MySpecies
  components:
  - type: HandheldTranslator
    spoken:
    - MySpecies
    understood:
    - MySpecies
    requires:
    - MySpecies
```

### 8) Частые ошибки и проверки

- Отсутствует `speaks` или `understands` у `LanguageKnowledge`- будет `RequiredFieldNotMappedException`.
- В `ReplacementObfuscation` передана строка вместо списка- будет `ArgumentException: No mapping node provided...`.
- Забыли локализацию- язык отобразится с ключом вместо названия/описания.
- Цвет без кавычек/невалидный HEX- язык может не окраситься.
- Радио «чистое»- проверьте `allowRadio: true` и что язык действительно выбран у говорящего.

### 9) Чек-лист перед коммитом

- [ ] Прототип языка создан и валиден.
- [ ] Локализация `name` и `description` добавлена.
- [ ] Вид(ы) получили `LanguageKnowledge` с `Intergalactic` + вашим языком.
- [ ] Радио проверено (обфускация включена).
- [ ] Нет ошибок при загрузке прототипов.

### Примечания по обфускации

Текущая обфускация- пер-слово: каждое слово заменяется на элемент из `replacement`, при этом пробелы и знаки препинания (`. , ! ? :`) сохраняются. Это обеспечивает устойчивое «жаргонное» звучание и на локали, и на рации.



